Exception in thread Thread-1 (run): Traceback (most recent call last): File "C:\Users\carve\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner self.run() ~~~~~~~~^^ File "C:\Users\carve\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run self._target(*self._args, **self._kwargs) ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ File "C:\Users\carve\OneDrive\Documents\computer doc\'25 zFall\PythonProject\etl_worker.py", line 229, in run self.process_record(record, cursor) ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^ File "C:\Users\carve\OneDrive\Documents\computer doc\'25 zFall\PythonProject\etl_worker.py", line 206, in process_record self.extract_playlist_data(record, cursor, tables['Playlist']['columns'], 'Playlist') ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ File "C:\Users\carve\OneDrive\Documents\computer doc\'25 zFall\PythonProject\etl_worker.py", line 46, in extract_playlist_data self.insert_row(row, columns, table, cursor) ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ File "C:\Users\carve\OneDrive\Documents\computer doc\'25 zFall\PythonProject\etl_worker.py", line 20, in insert_row raise e File "C:\Users\carve\OneDrive\Documents\computer doc\'25 zFall\PythonProject\etl_worker.py", line 13, in insert_row cursor.execute(sql, values) ~~~~~~~~~~~~~~^^^^^^^^^^^^^ pyodbc.IntegrityError: ('23000', '[23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Playlist_Channel". The conflict occurred in database "BD_Project", table "dbo.Channel", column \'C_ID\'. (547) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The statement has been terminated. (3621)')Channel : ['UCxGCIXa3qiw17_yd8YDng2w', '3 MISSISSIPPI', None, '3 MISSISSIPPI'] Duplicate entry skipped in table 'Channel' with values: ['UCxGCIXa3qiw17_yd8YDng2w', '3 MISSISSIPPI', None, '3 MISSISSIPPI'] Playlist : ['PLPWM_3gOp7IVYIvnEdb6nSwfMR1hMVawx', 'Crouch', 'https://www.youtube.com/playlist?list=PLPWM_3gOp7IVYIvnEdb6nSwfMR1hMVawx', 'UCxGCIXa3qiw17_yd8YDng2w'] Duplicate entry skipped in table 'Playlist' with values: ['PLPWM_3gOp7IVYIvnEdb6nSwfMR1hMVawx', 'Crouch', 'https://www.youtube.com/playlist?list=PLPWM_3gOp7IVYIvnEdb6nSwfMR1hMVawx', 'UCxGCIXa3qiw17_yd8YDng2w'] Video : ['krSDhi3wGYk', 'Collaborating with Farm Girl Banshee Moon and Exoman.. What is going on at The Crouch Ranch?', 'https://www.youtube.com/watch?v=krSDhi3wGYk', 'PLPWM_3gOp7IVYIvnEdb6nSwfMR1hMVawx', None, None, 2810, '2018-04-08', 'UCxGCIXa3qiw17_yd8YDng2w', None, 0] Duplicate entry skipped in table 'Video' with values: ['krSDhi3wGYk', 'Collaborating with Farm Girl Banshee Moon and Exoman.. What is going on at The Crouch Ranch?', 'https://www.youtube.com/watch?v=krSDhi3wGYk', 'PLPWM_3gOp7IVYIvnEdb6nSwfMR1hMVawx', None, None, 2810, '2018-04-08', 'UCxGCIXa3qiw17_yd8YDng2w', None, 0] Channel : ['UCZPX_PfuhUnzXBwRyBiASnQ', 'Pulsar Bangladesh', None, 'Pulsar Bangladesh'] Duplicate entry skipped in table 'Channel' with values: ['UCZPX_PfuhUnzXBwRyBiASnQ', 'Pulsar Bangladesh', None, 'Pulsar Bangladesh'] Playlist : ['PLuc_CkzXrUDj3Ml-3kvXUtJ1tWa3_nCzH', 'Pulsar Stunt Mania Teasers', 'https://www.youtube.com/playlist?list=PLuc_CkzXrUDj3Ml-3kvXUtJ1tWa3_nCzH', 'UCZPX_PfuhUnzXBwRyBiASnQ'] ['PLuc_CkzXrUDj3Ml-3kvXUtJ1tWa3_nCzH', 'Pulsar Stunt Mania Teasers', 'https://www.youtube.com/playlist?list=PLuc_CkzXrUDj3Ml-3kvXUtJ1tWa3_nCzH', 'UCZPX_PfuhUnzXBwRyBiASnQ']('23000', "[23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Violation of UNIQUE KEY constraint 'UQ__Channel__FF5AA50566BEAF91'. Cannot insert duplicate key in object 'dbo.Channel'. The duplicate key value is (<NULL>). (2627) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The statement has been terminated. (3621)")
Channel : ['UCZPX_PfuhUnzXBwRyBiASnQ', 'Pulsar Bangladesh', None, 'Pulsar Bangladesh'] Duplicate entry skipped in table 'Channel' with values: ['UCZPX_PfuhUnzXBwRyBiASnQ', 'Pulsar Bangladesh', None, 'Pulsar Bangladesh']
Exception in thread Thread-1 (run): Traceback (most recent call last): File "C:\Users\carve\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner self.run() ~~~~~~~~^^ File "C:\Users\carve\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run self._target(*self._args, **self._kwargs) ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ File "C:\Users\carve\OneDrive\Documents\computer doc\'25 zFall\PythonProject\etl_worker.py", line 235, in run self.write_metrics(cursor) ~~~~~~~~~~~~~~~~~~^^^^^^^^ File "C:\Users\carve\OneDrive\Documents\computer doc\'25 zFall\PythonProject\etl_worker.py", line 144, in write_metrics avg_playlist_len = float(sum(row[1] for row in playlist_durations) / len(playlist_durations)) ~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TypeError: unsupported operand type(s) for +: 'int' and 'NoneType'